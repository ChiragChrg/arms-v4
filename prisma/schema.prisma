generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URI")
}

model User {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  username   String   @unique
  email      String   @unique
  password   String?
  avatarImg  String   @default("")
  isApproved Boolean  @default(false)
  createdAt  DateTime @default(now()) @db.Date

  DocsCreator    Docs[]    @relation("DocsCreator")
  CourseCreator  Course[]  @relation("CourseCreator")
  SubjectCreator Subject[] @relation("SubjectCreator")
  UnitCreator    Unit[]    @relation("UnitCreator")
  UnitDocCreator UnitDoc[] @relation("UnitDocCreator")
}

model Docs {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  instituteName String   @unique()
  description   String
  createdAt     DateTime @default(now()) @db.Date

  courses   Course[]
  creator   User     @relation("DocsCreator", fields: [creatorId], references: [id])
  creatorId String   @db.ObjectId
}

model Course {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  courseName String
  courseDesc String
  createdAt  DateTime @default(now()) @db.Date

  subjects  Subject[]
  creator   User      @relation("CourseCreator", fields: [creatorId], references: [id])
  creatorId String    @db.ObjectId
  docs      Docs      @relation(fields: [docsId], references: [id])
  docsId    String    @db.ObjectId
}

model Subject {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  subjectName String
  subjectDesc String
  createdAt   DateTime @default(now()) @db.Date

  units     Unit[]
  creator   User   @relation("SubjectCreator", fields: [creatorId], references: [id])
  creatorId String @db.ObjectId
  course    Course @relation(fields: [courseId], references: [id])
  courseId  String @db.ObjectId
}

model Unit {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  unitName  String
  unitDesc  String
  createdAt DateTime @default(now()) @db.Date

  unitDocs  UnitDoc[]
  creator   User      @relation("UnitCreator", fields: [creatorId], references: [id])
  creatorId String    @db.ObjectId
  subject   Subject   @relation(fields: [subjectId], references: [id])
  subjectId String    @db.ObjectId
}

model UnitDoc {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  docName    String
  docSize    String
  docLink    String
  docCreated DateTime @db.Date

  creator   User   @relation("UnitDocCreator", fields: [creatorId], references: [id])
  creatorId String @db.ObjectId
  unit      Unit   @relation(fields: [unitId], references: [id])
  unitId    String @db.ObjectId
}
